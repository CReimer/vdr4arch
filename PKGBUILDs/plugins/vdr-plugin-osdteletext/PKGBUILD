# Maintainer: Christopher Reimer <c[dot]reimer[at]googlemail[dot]com>
pkgname=vdr-plugin-osdteletext
pkgver=0.9.3
_vdrapi=1.7.29
pkgrel=2
pkgdesc="A teletext viewer for VDR"
url="http://projects.vdr-developer.org/projects/plg-osdteletext"
arch=('x86_64' 'i686')
license=('GPL2')
depends=('gcc-libs' "vdr-api=${_vdrapi}")
optdepends=()
makedepends=()
conflicts=()
replaces=()
backup=()
install='vdr-plugin-osdteletext.install'
_plugname=$(echo $pkgname | sed 's/vdr-plugin-//g')
source=("http://projects.vdr-developer.org/attachments/download/912/vdr-$_plugname-$pkgver.tgz"
        'osdteletext-0.9.3-allow-cxx-override.diff')
md5sums=('e6a19d075fa99a3d81f29826d01ad9ba'
         '0a5913b42173bae39f33ebea0e9856b1')

package() {
  cd "${srcdir}/${_plugname}-${pkgver}"

  patch -i ${srcdir}/osdteletext-0.9.3-allow-cxx-override.diff

  mkdir -p $pkgdir/usr/lib/vdr/plugins
  make CFLAGS="$(pkg-config vdr --variable=plugincflags)" \
       CXXFLAGS="$(pkg-config vdr --variable=plugincflags)" \
       VDRDIR="$(pkg-config vdr --variable=includedir)/vdr" \
       LIBDIR="$pkgdir/$(pkg-config vdr --variable=plugindir)" \
       LOCALEDIR="$pkgdir/$(pkg-config vdr --variable=localedir)"

  install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
}
