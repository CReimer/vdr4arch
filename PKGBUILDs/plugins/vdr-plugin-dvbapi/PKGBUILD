# Maintainer: Christopher Reimer <c[dot]reimer[at]googlemail[dot]com>
pkgname=vdr-plugin-dvbapi
pkgver=1.0.2
_vdrapi=1.7.28
pkgrel=1
pkgdesc="A bridge between VDR and OScam."
url="https://github.com/manio/vdr-plugin-dvbapi"
arch=('x86_64' 'i686')
license=('GPL2')
depends=('gcc-libs' "vdr-api=${_vdrapi}")
optdepends=()
makedepends=()
conflicts=()
replaces=()
backup=()
install=''
source=("https://github.com/manio/$pkgname/tarball/v$pkgver")
md5sums=('59b395c23f74b3bb1e253fd1eae5166e')

package() {
  cd "${srcdir}/manio-${pkgname}-"*
  mkdir -p $pkgdir/usr/lib/vdr/plugins
  make CFLAGS="$CFLAGS -fPIC" \
       CXXFLAGS="$CXXFLAGS -fPIC" \
       VDRDIR=/usr/include/vdr \
       LIBDIR=$pkgdir/usr/lib/vdr/plugins \
       LOCALEDIR=$pkgdir/usr/share/locale \
       CPUOPT=native \
       PARALLEL=PARALLEL_128_SSE2 \
       CSAFLAGS="-O3 -fexpensive-optimizations -fPIC -funroll-loops -mmmx -msse -msse2"
  install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
  pkgver=${pkgver}_$_vdrapi
}
