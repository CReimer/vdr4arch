diff --git a/command/decoder.cpp b/command/decoder.cpp
index 4b207a1..f2d3cbb 100644
--- a/command/decoder.cpp
+++ b/command/decoder.cpp
@@ -152,7 +152,7 @@ cMarkAdDecoder::cMarkAdDecoder(bool useH264, int Threads)
     }
 
     video_codec=NULL;
-    CodecID video_codecid;
+    AVCodecID video_codecid;
 
     if (useH264)
     {
@@ -173,7 +173,7 @@ cMarkAdDecoder::cMarkAdDecoder(bool useH264, int Threads)
 
     if (video_codec)
     {
-        video_context = avcodec_alloc_context();
+        video_context = avcodec_alloc_context3(NULL);
         if (video_context)
         {
             if (video_codec->capabilities & CODEC_CAP_TRUNCATED)
@@ -323,7 +323,7 @@ bool cMarkAdDecoder::Clear()
     {
         avcodec_flush_buffers(video_context);
         AVCodecContext *dest;
-        dest=avcodec_alloc_context();
+        dest=avcodec_alloc_context3(NULL);
         if (dest)
         {
             if (avcodec_copy_context(dest,video_context)!=0) ret=false;
